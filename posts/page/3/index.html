<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Posts | metalelf0.github.io</title>
<meta name=keywords content><meta name=description content="Posts - metalelf0.github.io"><meta name=author content="metalelf0"><link rel=canonical href=https://metalelf0.github.io/posts/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://metalelf0.github.io/posts/index.xml><link rel=alternate hreflang=en href=https://metalelf0.github.io/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://metalelf0.github.io/posts/"><meta property="og:site_name" content="metalelf0.github.io"><meta property="og:title" content="Posts"><meta property="og:description" content="Andrea Schiavini is a ruby developer based in Milan, Italy"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Posts"><meta name=twitter:description content="Andrea Schiavini is a ruby developer based in Milan, Italy"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://metalelf0.github.io/posts/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://metalelf0.github.io/ accesskey=h title="metalelf0.github.io (Alt + H)">metalelf0.github.io</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://metalelf0.github.io/>Home</a></div><h1>Posts</h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Howto share Spree authentication/authorization engine</h2></header><div class=entry-content><p>In a project I’m working on I’m using spree as a mountable engine. The host application has its own administration area, and I wanted to share the spree authentication with my app.
Spree uses devise to handle authentication. The code which is responsible for the authentication part of the app is in the auth module of Spree.
To share authentication with your application you have to:
setup devise in your routes.rb file. I copied this code from the routes.rb file included in the spree/auth module: HostApplication::Application.routes.draw do devise_for :user, :class_name => 'Spree::User', :controllers => { :sessions => 'spree/user_sessions', :registrations => 'spree/user_registrations', :passwords => 'spree/user_passwords' }, :skip => [:unlocks, :omniauth_callbacks], :path_names => { :sign_out => 'logout' } # ... end add before_filter :authenticate_user! to the controller you want to be protected. This way you’re setup with authentication; it’s time to move on with authorization.
...</p></div><footer class=entry-footer><span title='2012-03-02 00:00:00 +0000 UTC'>March 2, 2012</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Howto share Spree authentication/authorization engine" href=https://metalelf0.github.io/posts/2012-03-02-howto-share-spree-authenticationauthorization-engine/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent></h2></header><div class=entry-content><p>I have a lot of Vim colorschemes, and I like to change them very often, reflecting my mood. I needed a way to showcase them all and quickly pick one.
The original Vim Color Scheme Test script by maverick.woo is written in Perl and the build works on Windows systems. I wanted to add some new features, and to test it with my own colorschemes, but as I’m not very confident with Perl, I preferred to start over with a new Ruby version instead of forking his project. Here’s my version (and here’s the github page):
...</p></div><footer class=entry-footer><span title='2012-02-06 00:00:00 +0000 UTC'>February 6, 2012</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to " href=https://metalelf0.github.io/posts/2012-02-06-the-right-colors-for-your-vim/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Using virtual attributes for multi parameter form helpers in Rails</h2></header><div class=entry-content><p>In a Rails application I am working on, I needed to setup a form with a field with a non-standard behaviour. The field represents a Date object, so the date_select FormHelper looked great; however, the date to display was not the actual date to be set on the database, but the day before. Changing all the data on the DB was a bit risky, so I had to stick with this requirement. I decided to use a virtual attribute to do this, as it seemed the most elegant solution, so I wrote this in my model:
...</p></div><footer class=entry-footer><span title='2011-10-28 00:00:00 +0000 UTC'>October 28, 2011</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Using virtual attributes for multi parameter form helpers in Rails" href=https://metalelf0.github.io/posts/2011-10-28-using-virtual-attributes-for-multi-parameter-form-helpers-in-rails/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Machinist vs Factory Girl: Machinist win!</h2></header><div class=entry-content><p>Today I decided to verify if Machinist could be a good replacement for Factory Girl. In our project, we have a big problem with Factory Girl: even if you tell her not to hit the database, using the Factory.build method, if an object has associations, these are saved on the DB. And this causes a huge slowdown in specs using factories. We’ve been using Factory Girl for nearly two years, and if we could find a way to stop him hitting the DB, we could really have a huge improvent in our test suite running time.
...</p></div><footer class=entry-footer><span title='2011-06-19 00:00:00 +0000 UTC'>June 19, 2011</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Machinist vs Factory Girl: Machinist win!" href=https://metalelf0.github.io/posts/2011-06-19-machinist-vs-factory-girl-machinist-win/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Howto run a rake task in sandbox mode</h2></header><div class=entry-content><p>If you have a Rails rake task that somehow changes your DB data, but you want to be sure that the DB will be rolled back to its previous state after the rake task has completed, you can simply include this snippet right after your task definition:
ActiveRecord::Base.connection.increment_open_transactions ActiveRecord::Base.connection.begin_db_transaction at_exit do ActiveRecord::Base.connection.rollback_db_transaction ActiveRecord::Base.connection.decrement_open_transactions end If you wonder where is this code coming from, it’s directly from the rails console code.</p></div><footer class=entry-footer><span title='2011-03-10 00:00:00 +0000 UTC'>March 10, 2011</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Howto run a rake task in sandbox mode" href=https://metalelf0.github.io/posts/2011-03-10-howto-run-a-rake-task-in-sandbox-mode/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=https://metalelf0.github.io/posts/page/2/>«&nbsp;Prev&nbsp;
</a><a class=next href=https://metalelf0.github.io/posts/page/4/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://metalelf0.github.io/>metalelf0.github.io</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>