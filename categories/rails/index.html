<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Rails | metalelf0.github.io</title>
<meta name=keywords content><meta name=description content="Andrea Schiavini is a ruby developer based in Milan, Italy"><meta name=author content="metalelf0"><link rel=canonical href=https://metalelf0.github.io/categories/rails/><link crossorigin=anonymous href=/assets/css/stylesheet.d6fcd20a4fb86efa4dfac8ec95da60244cc8871042183da1ef28e3a762ad79c8.css integrity="sha256-1vzSCk+4bvpN+sjsldpgJEzIhxBCGD2h7yjjp2Ktecg=" rel="preload stylesheet" as=style><link rel=icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://metalelf0.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://metalelf0.github.io/categories/rails/index.xml><link rel=alternate hreflang=en href=https://metalelf0.github.io/categories/rails/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://metalelf0.github.io/categories/rails/"><meta property="og:site_name" content="metalelf0.github.io"><meta property="og:title" content="Rails"><meta property="og:description" content="Andrea Schiavini is a ruby developer based in Milan, Italy"><meta property="og:locale" content="en-us"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rails"><meta name=twitter:description content="Andrea Schiavini is a ruby developer based in Milan, Italy"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://metalelf0.github.io/ accesskey=h title="metalelf0.github.io (Alt + H)">metalelf0.github.io</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://metalelf0.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://metalelf0.github.io/categories/>Categories</a></div><h1>Rails</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Mocked - a minitest pattern</h2></header><div class=entry-content><p>Minitest is good for mocking, right? Well… Minitest is gaining a lot of popularity and can actually be a 100% replacement for RSpec. It’s a pure ruby testing framework, it’s fast, light weight, and it supports both a test-unit like syntax and a spec engine with Rspec like syntax.
Still, when it comes to mocking, it can be a little painful. You have to initialize mocks and verify them manually after running the code under test.
...</p></div><footer class=entry-footer><span title='2016-05-11 00:00:00 +0000 UTC'>May 11, 2016</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Mocked - a minitest pattern" href=https://metalelf0.github.io/posts/2016-05-11-mocked-a-minitest-pattern/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Command pattern in ruby and rails</h2></header><div class=entry-content><p>The problem If you have a growing Rails application and you feel your models are getting too fat you might have a problem. We’ve all been educated with the “fat models, thin controllers” dogma - but sometimes putting all the domain logic inside the models has its downsides.
As an example, the typical flow of an ActiveRecord object through a Rails request involves:
fetching the object from the DB based on the params you receive (controller); doing something with the object inside the model (model); when something goes wrong, you set errors onto the model attributes (model); you finally return the object to the view, and present it accordingly (view). This is gonna tangle a lot of the domain logic to your model (scopes to retrieve objects, validations, and in the worst case even some presentation logic).
...</p></div><footer class=entry-footer><span title='2016-05-02 00:00:00 +0000 UTC'>May 2, 2016</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Command pattern in ruby and rails" href=https://metalelf0.github.io/posts/2016-05-02-command-pattern/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Null objects in Rails</h2></header><div class=entry-content><p>The problem Recently I’ve seen in a project I work on a lot of occurrences of this code:
if user.privacy && user.privacy.enables_page?(...) The first part of the condition above is a bad practice in object oriented design. It forces collaborators of user to know a part of its implementation
it could have a privacy or it couldn’t. What we want Wouldn’t it be much better to just write this:
if user.privacy.enables_page?(...) Hiding the responsibility inside the user class? It would be much cleaner and follow the Tell, don’t ask principle.
...</p></div><footer class=entry-footer><span title='2013-12-23 00:00:00 +0000 UTC'>December 23, 2013</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Null objects in Rails" href=https://metalelf0.github.io/posts/2013-12-23-null-objects-in-rails/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Easily change the path for your Paperclip attachments</h2></header><div class=entry-content><p>Today after releasing an app to production environment I saw a couple of paperclip warnings like this in my production.log file:
[paperclip] Duplicate URL for round_image with /system/:attachment/:id/:style/:filename. This will clash with attachment defined in PageElements::FranchisingCarouselEntry class This happens because I defined an attachment with the same name in two different models, and the default strategy Paperclip uses to choose attachment locations could lead to filename clashing.
Here is a more detailed example:
...</p></div><footer class=entry-footer><span title='2012-12-10 00:00:00 +0000 UTC'>December 10, 2012</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Easily change the path for your Paperclip attachments" href=https://metalelf0.github.io/posts/2012-12-10-easily-change-the-path-for-your-paperclip-attachments/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Howto share Spree authentication/authorization engine</h2></header><div class=entry-content><p>In a project I’m working on I’m using spree as a mountable engine. The host application has its own administration area, and I wanted to share the spree authentication with my app.
Spree uses devise to handle authentication. The code which is responsible for the authentication part of the app is in the auth module of Spree.
To share authentication with your application you have to:
setup devise in your routes.rb file. I copied this code from the routes.rb file included in the spree/auth module: HostApplication::Application.routes.draw do devise_for :user, :class_name => 'Spree::User', :controllers => { :sessions => 'spree/user_sessions', :registrations => 'spree/user_registrations', :passwords => 'spree/user_passwords' }, :skip => [:unlocks, :omniauth_callbacks], :path_names => { :sign_out => 'logout' } # ... end add before_filter :authenticate_user! to the controller you want to be protected. This way you’re setup with authentication; it’s time to move on with authorization.
...</p></div><footer class=entry-footer><span title='2012-03-02 00:00:00 +0000 UTC'>March 2, 2012</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;metalelf0</footer><a class=entry-link aria-label="post link to Howto share Spree authentication/authorization engine" href=https://metalelf0.github.io/posts/2012-03-02-howto-share-spree-authenticationauthorization-engine/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://metalelf0.github.io/categories/rails/page/2/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2024 <a href=https://metalelf0.github.io/>metalelf0.github.io</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>