<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Db on andreaschiavini.com</title><link>https://metalelf0.github.io/tags/db/</link><description>Recent content in Db on andreaschiavini.com</description><generator>Hugo</generator><language>en</language><lastBuildDate>Sun, 19 Jun 2011 00:00:00 +0000</lastBuildDate><atom:link href="https://metalelf0.github.io/tags/db/index.xml" rel="self" type="application/rss+xml"/><item><title>Machinist vs Factory Girl: Machinist win!</title><link>https://metalelf0.github.io/posts/2011-06-19-machinist-vs-factory-girl-machinist-win/</link><pubDate>Sun, 19 Jun 2011 00:00:00 +0000</pubDate><guid>https://metalelf0.github.io/posts/2011-06-19-machinist-vs-factory-girl-machinist-win/</guid><description>&lt;p>Today I decided to verify if &lt;a href="https://github.com/notahat/machinist" class="external-link" target="_blank" rel="noopener">Machinist&lt;/a> could be a good replacement for &lt;a href="https://github.com/thoughtbot/factory_girl" class="external-link" target="_blank" rel="noopener">Factory Girl&lt;/a>. In our project, we have a big problem with Factory Girl: even if you tell her not to hit the database, using the &lt;code>Factory.build&lt;/code> method, if an object has associations, these are saved on the DB. And this causes a huge slowdown in specs using factories. We&amp;rsquo;ve been using Factory Girl for nearly two years, and if we could find a way to stop him hitting the DB, we could really have a huge improvent in our test suite running time.&lt;/p></description></item><item><title>Howto run a rake task in sandbox mode</title><link>https://metalelf0.github.io/posts/2011-03-10-howto-run-a-rake-task-in-sandbox-mode/</link><pubDate>Thu, 10 Mar 2011 00:00:00 +0000</pubDate><guid>https://metalelf0.github.io/posts/2011-03-10-howto-run-a-rake-task-in-sandbox-mode/</guid><description>&lt;p>If you have a Rails rake task that somehow changes your DB data, but you want to be sure that the DB will be rolled back to its previous state after the rake task has completed, you can simply include this snippet right after your task definition:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="no">ActiveRecord&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Base&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connection&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">increment_open_transactions&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="no">ActiveRecord&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Base&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connection&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">begin_db_transaction&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">at_exit&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">ActiveRecord&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Base&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connection&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">rollback_db_transaction&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">ActiveRecord&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Base&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">connection&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">decrement_open_transactions&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you wonder where is this code coming from, it&amp;rsquo;s directly from the rails console code.&lt;/p></description></item></channel></rss>