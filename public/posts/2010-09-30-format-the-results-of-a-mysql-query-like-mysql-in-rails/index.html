<!DOCTYPE html>
<html lang="en">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  Format the results of a MySQL query like MySQL! In Rails! · metalelf0.github.io
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="metalelf0">
<meta name="description" content="It may happen that you need to display the results of a MySQL query on a page. E.g., your customer asks you to add a report on a page, and you don&rsquo;t want to build a custom template, but just write the query and see the results.
We can do this easily thanks to the terminal-table gem (see http://github.com/visionmedia/terminal-table). This gem allows printing an ASCII table, just like the one you see when you use MySQL from the terminal. Look at its page on GitHub to see how easy it is.">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Format the results of a MySQL query like MySQL! In Rails!">
  <meta name="twitter:description" content="It may happen that you need to display the results of a MySQL query on a page. E.g., your customer asks you to add a report on a page, and you don’t want to build a custom template, but just write the query and see the results.
We can do this easily thanks to the terminal-table gem (see http://github.com/visionmedia/terminal-table). This gem allows printing an ASCII table, just like the one you see when you use MySQL from the terminal. Look at its page on GitHub to see how easy it is.">

<meta property="og:url" content="http://localhost:1313/posts/2010-09-30-format-the-results-of-a-mysql-query-like-mysql-in-rails/">
  <meta property="og:site_name" content="metalelf0.github.io">
  <meta property="og:title" content="Format the results of a MySQL query like MySQL! In Rails!">
  <meta property="og:description" content="It may happen that you need to display the results of a MySQL query on a page. E.g., your customer asks you to add a report on a page, and you don’t want to build a custom template, but just write the query and see the results.
We can do this easily thanks to the terminal-table gem (see http://github.com/visionmedia/terminal-table). This gem allows printing an ASCII table, just like the one you see when you use MySQL from the terminal. Look at its page on GitHub to see how easy it is.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2010-09-30T00:00:00+00:00">
    <meta property="article:modified_time" content="2010-09-30T00:00:00+00:00">
    <meta property="article:tag" content="Ruby">
    <meta property="article:tag" content="Mysql">
    <meta property="article:tag" content="Rails">
    <meta property="article:tag" content="Table">
    <meta property="article:tag" content="Terminal-Table">




<link rel="canonical" href="http://localhost:1313/posts/2010-09-30-format-the-results-of-a-mysql-query-like-mysql-in-rails/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      metalelf0.github.io
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/2010-09-30-format-the-results-of-a-mysql-query-like-mysql-in-rails/">
              Format the results of a MySQL query like MySQL! In Rails!
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2010-09-30T00:00:00Z">
                September 30, 2010
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/rails/">Rails</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/ruby/">Ruby</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/mysql/">Mysql</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/rails/">Rails</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/table/">Table</a>
    </span>
      <span class="separator">•</span>
    <span class="tag">
      <a href="/tags/terminal-table/">Terminal-Table</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>It may happen that you need to display the results of a MySQL query on a page. E.g., your customer asks you to add a report on a page, and you don&rsquo;t want to build a custom template, but just write the query and see the results.</p>
<p>We can do this easily thanks to the terminal-table gem (see <!-- raw HTML omitted --><a href="http://github.com/visionmedia/terminal-table"  class="external-link" target="_blank" rel="noopener">http://github.com/visionmedia/terminal-table</a><!-- raw HTML omitted -->). This gem allows printing an ASCII table, just like the one you see when you use MySQL from the terminal. Look at its page on GitHub to see how easy it is.</p>
<p>To integrate it with MySQL and Rails, we can use <code>ActiveRecord::Base.connection.execute(&quot;some_sql_query&quot;)</code>. This method extracts the result of our query to a <code>Mysql::Result</code> object, which consists of a set of hashes with the results of the query. We can navigate through this hashes iterating over the all_hashes method, and throw these results into a table. Here&rsquo;s the code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="k">module</span> <span class="nn">MysqlQueryResultsFormatter</span>
</span></span><span class="line"><span class="cl">  <span class="nb">require</span> <span class="s1">&#39;terminal-table/import&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">def</span> <span class="nf">print_results_of_query</span> <span class="n">query</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kp">nil</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">nil?</span>
</span></span><span class="line"><span class="cl">    <span class="n">results_table</span> <span class="o">=</span> <span class="n">table</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">      <span class="n">results</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">all_hashes</span>
</span></span><span class="line"><span class="cl">      <span class="n">t</span><span class="o">.</span><span class="n">headings</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">keys</span>
</span></span><span class="line"><span class="cl">      <span class="n">results</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">each_row</span><span class="o">|</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span> <span class="o">&lt;&lt;</span> <span class="n">each_row</span><span class="o">.</span><span class="n">values</span>
</span></span><span class="line"><span class="cl">      <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="k">end</span>
</span></span><span class="line"><span class="cl">    <span class="nb">puts</span> <span class="n">results_table</span>
</span></span><span class="line"><span class="cl">  <span class="k">end</span>
</span></span><span class="line"><span class="cl"><span class="k">end</span>
</span></span></code></pre></div><p>So all we need to do is include our module and call the method <code>print_results_of_query</code>.</p>
<p>Just wrap it into <code>&lt;%=</code> and <code>%&gt;</code> markers in your .html.erb template. Have fun!</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2010 -
    
    2024
     metalelf0 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
